2025-07-21 11:18:06,029 - tai_park_training - INFO -  Starting Taï Park Species Classification Training
2025-07-21 11:18:06,030 - tai_park_training - INFO -  Output directory: results\models\debug_efficientnet_b4\models
2025-07-21 11:18:06,030 - tai_park_training - INFO -  Configuration: configs/base_config.yaml
2025-07-21 11:18:06,030 - tai_park_training - INFO -  Creating data loaders...
2025-07-21 11:18:09,442 - tai_park_training - INFO -  Creating model...
2025-07-21 11:18:09,821 - tai_park_training - INFO -  MODEL INFORMATION
2025-07-21 11:18:09,821 - tai_park_training - INFO - ==================================================
2025-07-21 11:18:09,822 - tai_park_training - INFO -  Model: efficientnet_b4
2025-07-21 11:18:09,824 - tai_park_training - INFO -  Parameters:
2025-07-21 11:18:09,824 - tai_park_training - INFO -    Total: 19,651,664
2025-07-21 11:18:09,824 - tai_park_training - INFO -    Trainable: 19,651,664
2025-07-21 11:18:09,824 - tai_park_training - INFO -    Frozen: 0
2025-07-21 11:18:09,825 - tai_park_training - INFO -  Estimated model size: 75.45 MB
2025-07-21 11:18:09,825 - tai_park_training - INFO -   Architecture:
2025-07-21 11:18:09,826 - tai_park_training - INFO -    backbone: EfficientNet
2025-07-21 11:18:09,826 - tai_park_training - INFO -    classifier: Sequential
2025-07-21 11:18:09,826 - tai_park_training - INFO -  use_site_embedding: False
2025-07-21 11:18:09,826 - tai_park_training - INFO -  use_attention: False
2025-07-21 11:18:09,826 - tai_park_training - INFO -  num_classes: 8
2025-07-21 11:18:09,827 - tai_park_training - INFO -  feature_dim: 1792
2025-07-21 11:18:09,827 - tai_park_training - INFO -   TRAINING CONFIGURATION
2025-07-21 11:18:09,827 - tai_park_training - INFO - ==================================================
2025-07-21 11:18:09,827 - tai_park_training - INFO -  Training:
2025-07-21 11:18:09,827 - tai_park_training - INFO -    Epochs: 1
2025-07-21 11:18:09,828 - tai_park_training - INFO -    Batch size: 8
2025-07-21 11:18:09,828 - tai_park_training - INFO -    Learning rate: 0.001
2025-07-21 11:18:09,828 - tai_park_training - INFO -    Weight decay: 0.0001
2025-07-21 11:18:09,828 - tai_park_training - INFO -    Early stopping patience: 10
2025-07-21 11:18:09,828 - tai_park_training - INFO -  Data:
2025-07-21 11:18:09,828 - tai_park_training - INFO -    Data directory: data/raw
2025-07-21 11:18:09,829 - tai_park_training - INFO -    Image size: [224, 224]
2025-07-21 11:18:09,829 - tai_park_training - INFO -    Number of workers: N/A
2025-07-21 11:18:09,829 - tai_park_training - INFO -    Sampler type: N/A
2025-07-21 11:18:09,829 - tai_park_training - INFO -    Aggressive augmentation: False
2025-07-21 11:18:09,829 - tai_park_training - INFO -  Model:
2025-07-21 11:18:09,829 - tai_park_training - INFO -    Architecture: efficientnet_b4
2025-07-21 11:18:09,830 - tai_park_training - INFO -    Pretrained: False
2025-07-21 11:18:09,830 - tai_park_training - INFO -    Dropout: 0.5
2025-07-21 11:18:09,830 - tai_park_training - INFO -    Freeze backbone: False
2025-07-21 11:18:09,830 - tai_park_training - INFO -  Hardware:
2025-07-21 11:18:09,830 - tai_park_training - INFO -    Device: auto
2025-07-21 11:18:09,830 - tai_park_training - INFO -    Mixed precision: False
2025-07-21 11:18:09,831 - tai_park_training - INFO -    Compile: False
2025-07-21 11:18:09,831 - tai_park_training - INFO -  Logging:
2025-07-21 11:18:09,831 - tai_park_training - INFO -    W&B enabled: False
2025-07-21 11:18:09,831 - tai_park_training - INFO -    Experiment name: debug_efficientnet_b4
2025-07-21 11:18:09,831 - tai_park_training - INFO -    Log level: INFO
2025-07-21 11:18:09,839 - tai_park_training - INFO -  Trainer initialized with mixed precision: False
2025-07-21 11:18:09,840 - tai_park_training - INFO -  Quick test mode - training for 2 epochs
2025-07-21 11:18:09,840 - tai_park_training - INFO -  Starting training...
2025-07-21 11:18:09,840 - tai_park_training - INFO -  Starting training for 2 epochs
2025-07-21 11:18:09,840 - tai_park_training - INFO -  Training samples: 13484
2025-07-21 11:18:09,841 - tai_park_training - INFO -  Validation samples: 3004
2025-07-21 11:18:24,202 - tai_park_training - ERROR -  Training failed: element 0 of tensors does not require grad and does not have a grad_fn
2025-07-21 11:18:24,206 - tai_park_training - ERROR - Traceback (most recent call last):
  File "C:\Users\gonza\Documents\Conser-vision-Practice-Area-Image-Classification\scripts\train_model.py", line 457, in main
    trainer.train(
    ~~~~~~~~~~~~~^
        train_loader=data_manager.train_loader,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        start_epoch=start_epoch
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\gonza\Documents\Conser-vision-Practice-Area-Image-Classification\src\training\trainer.py", line 381, in train
    train_metrics = self.train_epoch(train_loader)
  File "C:\Users\gonza\Documents\Conser-vision-Practice-Area-Image-Classification\src\training\trainer.py", line 151, in train_epoch
    loss.backward()
    ~~~~~~~~~~~~~^^
  File "C:\Users\gonza\Documents\Conser-vision-Practice-Area-Image-Classification\tai-park-env\Lib\site-packages\torch\_tensor.py", line 648, in backward
    torch.autograd.backward(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        self, gradient, retain_graph, create_graph, inputs=inputs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\gonza\Documents\Conser-vision-Practice-Area-Image-Classification\tai-park-env\Lib\site-packages\torch\autograd\__init__.py", line 353, in backward
    _engine_run_backward(
    ~~~~~~~~~~~~~~~~~~~~^
        tensors,
        ^^^^^^^^
    ...<5 lines>...
        accumulate_grad=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\gonza\Documents\Conser-vision-Practice-Area-Image-Classification\tai-park-env\Lib\site-packages\torch\autograd\graph.py", line 824, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        t_outputs, *args, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )  # Calls into the C++ engine to run the backward pass
    ^
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn

